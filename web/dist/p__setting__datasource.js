(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[418],{54977:function(K,S,t){"use strict";t.d(S,{Z:function(){return V}});var R=t(28991),P=t(67294),Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},D=Y,G=t(27029),w=function(O,N){return P.createElement(G.Z,(0,R.Z)((0,R.Z)({},O),{},{ref:N,icon:D}))},J=P.forwardRef(w),V=J},16894:function(K,S,t){"use strict";var R=t(78775),P=t(36839);S.ZP=P.Z},42414:function(K,S,t){"use strict";t.r(S),t.d(S,{default:function(){return we}});var R=t(57663),P=t(71577),Y=t(62350),D=t(24565),G=t(48736),w=t(27049),J=t(22385),V=t(45777),ce=t(54029),O=t(79166),N=t(43358),E=t(34041),H=t(93224),I=t(2824),o=t(39428),Z=t(11849),_e=t(34792),f=t(48086),g=t(3182),oe=t(54977),me=t(73171),pe=t(49101),j=t(67294),fe=t(67265),L=t(16894),er=t(71194),Q=t(50146),u=t(85029),e=t(85893),he=function(i){var m=i.modalVisible,a=i.onCancel;return(0,e.jsx)(Q.Z,{destroyOnClose:!0,title:(0,e.jsx)(u._H,{id:"pages.searchTable.operate.create"}),visible:m,onCancel:function(){return a()},footer:null,children:i.children})},ve=he,Ze=function(i){var m=i.updateModalVisible,a=i.onCancel;return(0,e.jsx)(Q.Z,{destroyOnClose:!0,title:(0,e.jsx)(u._H,{id:"pages.searchTable.operate.update"}),visible:m,onCancel:function(){return a()},footer:null,children:i.children})},ge=Ze,C=t(21704);function ye(c){return M.apply(this,arguments)}function M(){return M=(0,g.Z)((0,o.Z)().mark(function c(i){return(0,o.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,C.WY)("/api/v1/datasource/list",{params:i}));case 1:case"end":return a.stop()}},c)})),M.apply(this,arguments)}function be(c){return $.apply(this,arguments)}function $(){return $=(0,g.Z)((0,o.Z)().mark(function c(i){return(0,o.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,C.WY)("/api/v1/datasource/list",{method:"DELETE",data:(0,Z.Z)({},i)}));case 1:case"end":return a.stop()}},c)})),$.apply(this,arguments)}function je(c){return A.apply(this,arguments)}function A(){return A=(0,g.Z)((0,o.Z)().mark(function c(i){return(0,o.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,C.WY)("/api/v1/datasource/list",{method:"POST",data:(0,Z.Z)({},i)}));case 1:case"end":return a.stop()}},c)})),A.apply(this,arguments)}function xe(c){return U.apply(this,arguments)}function U(){return U=(0,g.Z)((0,o.Z)().mark(function c(i){return(0,o.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,C.WY)("/api/v1/datasource/list",{method:"PUT",data:(0,Z.Z)({},i)}));case 1:case"end":return a.stop()}},c)})),U.apply(this,arguments)}function Ie(c){return W.apply(this,arguments)}function W(){return W=(0,g.Z)((0,o.Z)().mark(function c(i){return(0,o.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,C.WY)("/api/v1/datasource/check",{method:"POST",data:(0,Z.Z)({},i)}));case 1:case"end":return a.stop()}},c)})),W.apply(this,arguments)}var Te=["type","defaultRender"],Fe=["type","defaultRender"],Se=["type","defaultRender"],Pe=["type","defaultRender"],Ee=["type","defaultRender"],He=["type","defaultRender"],Ce={layout:"horizontal",formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}},Re=function(){var c=(0,g.Z)((0,o.Z)().mark(function i(m){var a;return(0,o.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=f.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),l.prev=1,l.next=4,je((0,Z.Z)({},m));case 4:return a(),f.ZP.success("\u6DFB\u52A0\u6210\u529F"),l.abrupt("return",!0);case 9:return l.prev=9,l.t0=l.catch(1),a(),f.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),l.abrupt("return",!1);case 14:case"end":return l.stop()}},i,null,[[1,9]])}));return function(m){return c.apply(this,arguments)}}(),Ve=function(){var c=(0,g.Z)((0,o.Z)().mark(function i(m,a){var y;return(0,o.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return y=f.ZP.loading("\u6B63\u5728\u914D\u7F6E"),v.prev=1,v.next=4,xe((0,Z.Z)((0,Z.Z)({},m),{},{id:a}));case 4:return y(),f.ZP.success("\u4FEE\u6539\u6210\u529F"),v.abrupt("return",!0);case 9:return v.prev=9,v.t0=v.catch(1),y(),f.ZP.error("\u4FEE\u6539\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),v.abrupt("return",!1);case 14:case"end":return v.stop()}},i,null,[[1,9]])}));return function(m,a){return c.apply(this,arguments)}}(),Oe=function(){var c=(0,g.Z)((0,o.Z)().mark(function i(m){var a;return(0,o.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=f.ZP.loading("\u6B63\u5728\u5220\u9664"),l.prev=1,l.next=4,be({id:m});case 4:return a(),f.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),l.abrupt("return",!0);case 9:return l.prev=9,l.t0=l.catch(1),a(),f.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),l.abrupt("return",!1);case 14:case"end":return l.stop()}},i,null,[[1,9]])}));return function(m){return c.apply(this,arguments)}}(),X=function(){var c=(0,g.Z)((0,o.Z)().mark(function i(m){var a;return(0,o.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return a=f.ZP.loading("\u6B63\u5728\u68C0\u67E5\u8FDE\u63A5"),l.prev=1,l.next=4,Ie((0,Z.Z)({},m));case 4:return a(),l.abrupt("return",!0);case 8:return l.prev=8,l.t0=l.catch(1),a(),l.abrupt("return",!1);case 12:case"end":return l.stop()}},i,null,[[1,8]])}));return function(m){return c.apply(this,arguments)}}(),q={idc:"",env:"",type:"",host:"",name:"",port:"",user:"",pass:"",dbid:"",enable:"",execute_enable:"",dbmeta_enable:""},De=function(){var i=(0,j.useState)(!1),m=(0,I.Z)(i,2),a=m[0],y=m[1],l=(0,j.useState)(!1),v=(0,I.Z)(l,2),Le=v[0],k=v[1],Me=(0,j.useState)(q),_=(0,I.Z)(Me,2),b=_[0],ee=_[1],F=(0,j.useRef)(),B=(0,u.md)(),$e=(0,j.useState)([{id:0,idc_key:"",idc_name:""}]),re=(0,I.Z)($e,2),ae=re[0],Ae=re[1],Ue=(0,j.useState)({}),te=(0,I.Z)(Ue,2),We=te[0],ke=te[1],Be=(0,j.useState)([{id:0,env_key:"",env_name:""}]),ne=(0,I.Z)(Be,2),se=ne[0],ze=ne[1],Ke=(0,j.useState)({}),ue=(0,I.Z)(Ke,2),Ye=ue[0],Ge=ue[1],Je=(0,j.useState)([{id:0,name:""}]),le=(0,I.Z)(Je,2),ie=le[0],Ne=le[1],Qe=(0,j.useState)({}),de=(0,I.Z)(Qe,2),Xe=de[0],qe=de[1];(0,j.useEffect)(function(){fetch("/api/v1/datasource_idc/list").then(function(s){return s.json()}).then(function(s){Ae(s.data);var d={};s.data.forEach(function(r){d[r.id]=r.idc_key}),ke(d)}).catch(function(s){console.log("Fetch cluster list failed",s)}),fetch("/api/v1/datasource_env/list").then(function(s){return s.json()}).then(function(s){ze(s.data);var d={};s.data.forEach(function(r){d[r.id]=r.env_key}),Ge(d)}).catch(function(s){console.log("Fetch cluster list failed",s)}),fetch("/api/v1/datasource_type/list").then(function(s){return s.json()}).then(function(s){Ne(s.data);var d={};s.data.forEach(function(r){d[r.id]=r.name}),qe(d)}).catch(function(s){console.log("Fetch cluster list failed",s)})},[]);var z=[{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.datasource"}),dataIndex:"name",initialValue:b.name,sorter:!0,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]}},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.type"}),dataIndex:"type",initialValue:b.type,filters:!0,onFilter:!0,sorter:!0,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]},renderFormItem:function(d,r,p){var h=r.type,T=r.defaultRender,n=(0,H.Z)(r,Te);return(0,e.jsx)(E.Z,{showSearch:!0,children:ie&&ie.map(function(x){return(0,e.jsx)(Option,{value:x.name,children:x.name},x.name)})})},valueEnum:Xe},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.host"}),dataIndex:"host",initialValue:b.host,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]}},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.port"}),dataIndex:"port",initialValue:b.port,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]}},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.user"}),dataIndex:"user",hideInTable:!0,hideInSearch:!0,initialValue:b.user},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.password"}),dataIndex:"pass",hideInTable:!0,hideInSearch:!0,initialValue:"",valueType:"password"},{title:"DBID",dataIndex:"dbid",hideInTable:!0,hideInSearch:!0,initialValue:b.dbid},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.idc"}),dataIndex:"idc",initialValue:b.idc,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]},renderFormItem:function(d,r,p){var h=r.type,T=r.defaultRender,n=(0,H.Z)(r,Fe);return(0,e.jsx)(E.Z,{showSearch:!0,children:ae&&ae.map(function(x){return(0,e.jsx)(Option,{value:x.idc_key,children:x.idc_name},x.idc_key)})})},valueEnum:We},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.env"}),dataIndex:"env",initialValue:b.env,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]},renderFormItem:function(d,r,p){var h=r.type,T=r.defaultRender,n=(0,H.Z)(r,Se);return(0,e.jsx)(E.Z,{showSearch:!0,children:se&&se.map(function(x){return(0,e.jsx)(Option,{value:x.env_key,children:x.env_name},x.env_key)})})},valueEnum:Ye},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.enable"}),dataIndex:"enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:b.enable,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]},renderFormItem:function(d,r,p){var h=r.type,T=r.defaultRender,n=(0,H.Z)(r,Pe);return(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(Option,{value:0,children:"\u5426"},0),(0,e.jsx)(Option,{value:1,children:"\u662F"},1)]})}},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.execute_enable"}),dataIndex:"execute_enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:b.execute_enable,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]},renderFormItem:function(d,r,p){var h=r.type,T=r.defaultRender,n=(0,H.Z)(r,Ee);return(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(Option,{value:0,children:(0,e.jsx)(u._H,{id:"pages.searchTable.column.no"})},0),(0,e.jsx)(Option,{value:1,children:(0,e.jsx)(u._H,{id:"pages.searchTable.column.yes"})},1)]})}},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.dbmeta_enable"}),dataIndex:"dbmeta_enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:b.dbmeta_enable,formItemProps:{rules:[{required:!0,message:(0,e.jsx)(u._H,{id:"pages.searchTable.form.requireItem"})}]},renderFormItem:function(d,r,p){var h=r.type,T=r.defaultRender,n=(0,H.Z)(r,He);return(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(Option,{value:0,children:(0,e.jsx)(u._H,{id:"pages.searchTable.column.no"})},0),(0,e.jsx)(Option,{value:1,children:(0,e.jsx)(u._H,{id:"pages.searchTable.column.yes"})},1)]})}},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.status"}),dataIndex:"status",filters:!0,onFilter:!0,render:function(d,r){return d=="1"?(0,e.jsx)(V.Z,{title:r.status_text,children:(0,e.jsx)(O.Z,{status:"success"})}):(0,e.jsx)(V.Z,{title:r.status_text,children:(0,e.jsx)(O.Z,{status:"error"})})},hideInForm:!0},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.gmtCreated"}),dataIndex:"gmt_created",sorter:!1,valueType:"dateTime",hideInForm:!0,hideInTable:!0,hideInSearch:!0},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.gmtUpdated"}),dataIndex:"gmt_updated",sorter:!1,valueType:"dateTime",hideInForm:!0,hideInTable:!0,hideInSearch:!0},{title:(0,e.jsx)(u._H,{id:"pages.searchTable.column.operate"}),dataIndex:"option",valueType:"option",render:function(d,r){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("a",{onClick:function(){k(!0),ee(r)},children:[(0,e.jsx)(oe.Z,{}),(0,e.jsx)(u._H,{id:"pages.searchTable.operate.edit"})]}),(0,e.jsx)(w.Z,{type:"vertical"}),(0,e.jsx)(D.Z,{title:"\u786E\u8BA4\u8981\u5220\u9664\u6570\u636E\u3010".concat(r.id,"\u3011,\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F"),placement:"left",onConfirm:(0,g.Z)((0,o.Z)().mark(function p(){var h;return(0,o.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(B.canAdmin){n.next=3;break}return f.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),n.abrupt("return");case 3:return n.next=5,Oe(r.id);case 5:h=n.sent,h&&F.current&&F.current.reload();case 7:case"end":return n.stop()}},p)})),children:(0,e.jsxs)("a",{children:[(0,e.jsx)(me.Z,{}),(0,e.jsx)(u._H,{id:"pages.searchTable.operate.delete"})]})})]})}}];return(0,e.jsxs)(fe.ZP,{children:[(0,e.jsx)(L.ZP,(0,Z.Z)((0,Z.Z)({},Ce),{},{headerTitle:(0,e.jsx)(u._H,{id:"pages.searchTable.datalist"}),actionRef:F,rowKey:"id",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsxs)(P.Z,{type:"primary",onClick:function(){y(!0),ee(q)},children:[(0,e.jsx)(pe.Z,{}),(0,e.jsx)(u._H,{id:"pages.searchTable.operate.create"})]})]},request:function(d,r,p){return ye((0,Z.Z)((0,Z.Z)({},d),{},{sorter:r,filter:p}))},columns:z,pagination:{pageSize:10}})),(0,e.jsx)(ve,{onCancel:function(){return y(!1)},modalVisible:a,children:(0,e.jsx)(L.ZP,{onSubmit:function(){var s=(0,g.Z)((0,o.Z)().mark(function d(r){var p,h;return(0,o.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(B.canAdmin){n.next=3;break}return f.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),n.abrupt("return");case 3:return n.next=5,X(r);case 5:if(p=n.sent,p){n.next=9;break}return f.ZP.error("\u6570\u636E\u5E93\u8FDE\u63A5\u68C0\u67E5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6E90\u914D\u7F6E\u662F\u5426\u6B63\u786E"),n.abrupt("return");case 9:return n.next=11,Re(r);case 11:h=n.sent,h&&(y(!1),F.current&&F.current.reload());case 13:case"end":return n.stop()}},d)}));return function(d){return s.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:z})}),(0,e.jsx)(ge,{onCancel:function(){return k(!1)},updateModalVisible:Le,children:(0,e.jsx)(L.ZP,{onSubmit:function(){var s=(0,g.Z)((0,o.Z)().mark(function d(r){var p,h;return(0,o.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(B.canAdmin){n.next=3;break}return f.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),n.abrupt("return");case 3:return n.next=5,X(r);case 5:if(p=n.sent,p){n.next=9;break}return f.ZP.error("\u6570\u636E\u5E93\u8FDE\u63A5\u68C0\u67E5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6E90\u914D\u7F6E\u662F\u5426\u6B63\u786E"),n.abrupt("return");case 9:return n.next=11,Ve(r,b.id);case 11:h=n.sent,h&&(k(!1),F.current&&F.current.reload());case 13:case"end":return n.stop()}},d)}));return function(d){return s.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:z})})]})},we=De}}]);
