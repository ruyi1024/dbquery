(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2418],{54977:function(ie,R,u){"use strict";u.d(R,{Z:function(){return H}});var T=u(28991),C=u(67294),Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},D=Y,K=u(27029),V=function(G,O){return C.createElement(K.Z,(0,T.Z)((0,T.Z)({},G),{},{ref:O,icon:D}))};V.displayName="FormOutlined";var H=C.forwardRef(V)},42414:function(ie,R,u){"use strict";u.r(R),u.d(R,{default:function(){return Ae}});var T=u(57663),C=u(71577),Y=u(62350),D=u(75443),K=u(48736),V=u(27049),H=u(22385),w=u(61580),G=u(54029),O=u(79166),rr=u(43358),j=u(34041),S=u(81253),b=u(28481),c=u(55507),Z=u(28991),tr=u(34792),p=u(48086),y=u(92137),de=u(54977),ce=u(73171),oe=u(49101),F=u(67294),me=u(47599),L=u(40418),ar=u(71194),N=u(77175),r=u(85893),fe=function(l){var o=l.modalVisible,t=l.onCancel;return(0,r.jsx)(N.Z,{destroyOnClose:!0,title:"\u65B0\u5EFA",visible:o,onCancel:function(){return t()},footer:null,children:l.children})},pe=fe,ve=function(l){var o=l.updateModalVisible,t=l.onCancel;return(0,r.jsx)(N.Z,{destroyOnClose:!0,title:"\u4FEE\u6539",visible:o,onCancel:function(){return t()},footer:null,children:l.children})},he=ve,P=u(3140);function Ze(d){return $.apply(this,arguments)}function $(){return $=(0,y.Z)((0,c.Z)().mark(function d(l){return(0,c.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,P.WY)("/api/v1/datasource/list",{params:l}));case 1:case"end":return t.stop()}},d)})),$.apply(this,arguments)}function ye(d){return A.apply(this,arguments)}function A(){return A=(0,y.Z)((0,c.Z)().mark(function d(l){return(0,c.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,P.WY)("/api/v1/datasource/list",{method:"DELETE",data:(0,Z.Z)({},l)}));case 1:case"end":return t.stop()}},d)})),A.apply(this,arguments)}function Ie(d){return M.apply(this,arguments)}function M(){return M=(0,y.Z)((0,c.Z)().mark(function d(l){return(0,c.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,P.WY)("/api/v1/datasource/list",{method:"POST",data:(0,Z.Z)({},l)}));case 1:case"end":return t.stop()}},d)})),M.apply(this,arguments)}function Fe(d){return k.apply(this,arguments)}function k(){return k=(0,y.Z)((0,c.Z)().mark(function d(l){return(0,c.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,P.WY)("/api/v1/datasource/list",{method:"PUT",data:(0,Z.Z)({},l)}));case 1:case"end":return t.stop()}},d)})),k.apply(this,arguments)}function xe(d){return B.apply(this,arguments)}function B(){return B=(0,y.Z)((0,c.Z)().mark(function d(l){return(0,c.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,P.WY)("/api/v1/datasource/check",{method:"POST",data:(0,Z.Z)({},l)}));case 1:case"end":return t.stop()}},d)})),B.apply(this,arguments)}var ge=u(85029),je=["type","defaultRender"],Se=["type","defaultRender"],be=["type","defaultRender"],Ee=["type","defaultRender"],Pe=["type","defaultRender"],Re=["type","defaultRender"],Ce=["type","defaultRender"],Ve=["type","defaultRender"],Oe=["type","defaultRender"],Te={layout:"horizontal",formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}}},De=function(){var d=(0,y.Z)((0,c.Z)().mark(function l(o){var t;return(0,c.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=p.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),s.prev=1,s.next=4,Ie((0,Z.Z)({},o));case 4:return t(),p.ZP.success("\u6DFB\u52A0\u6210\u529F"),s.abrupt("return",!0);case 9:return s.prev=9,s.t0=s.catch(1),t(),p.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),s.abrupt("return",!1);case 14:case"end":return s.stop()}},l,null,[[1,9]])}));return function(o){return d.apply(this,arguments)}}(),we=function(){var d=(0,y.Z)((0,c.Z)().mark(function l(o,t){var I;return(0,c.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return I=p.ZP.loading("\u6B63\u5728\u914D\u7F6E"),h.prev=1,h.next=4,Fe((0,Z.Z)((0,Z.Z)({},o),{},{id:t}));case 4:return I(),p.ZP.success("\u4FEE\u6539\u6210\u529F"),h.abrupt("return",!0);case 9:return h.prev=9,h.t0=h.catch(1),I(),p.ZP.error("\u4FEE\u6539\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),h.abrupt("return",!1);case 14:case"end":return h.stop()}},l,null,[[1,9]])}));return function(o,t){return d.apply(this,arguments)}}(),Le=function(){var d=(0,y.Z)((0,c.Z)().mark(function l(o){var t;return(0,c.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=p.ZP.loading("\u6B63\u5728\u5220\u9664"),s.prev=1,s.next=4,ye({id:o});case 4:return t(),p.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),s.abrupt("return",!0);case 9:return s.prev=9,s.t0=s.catch(1),t(),p.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),s.abrupt("return",!1);case 14:case"end":return s.stop()}},l,null,[[1,9]])}));return function(o){return d.apply(this,arguments)}}(),J=function(){var d=(0,y.Z)((0,c.Z)().mark(function l(o){var t;return(0,c.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=p.ZP.loading("\u6B63\u5728\u68C0\u67E5\u8FDE\u63A5"),s.prev=1,s.next=4,xe((0,Z.Z)({},o));case 4:return t(),s.abrupt("return",!0);case 8:return s.prev=8,s.t0=s.catch(1),t(),s.abrupt("return",!1);case 12:case"end":return s.stop()}},l,null,[[1,8]])}));return function(o){return d.apply(this,arguments)}}(),Q={idc:"",env:"",type:"",host:"",name:"",port:"",user:"",pass:"",dbid:"",enable:"",execute_enable:"",dbmeta_enable:"",sensitive_enable:"",monitor_enable:"",alarm_enable:""},$e=function(){var l=(0,F.useState)(!1),o=(0,b.Z)(l,2),t=o[0],I=o[1],s=(0,F.useState)(!1),h=(0,b.Z)(s,2),Me=h[0],U=h[1],ke=(0,F.useState)(Q),X=(0,b.Z)(ke,2),v=X[0],q=X[1],E=(0,F.useRef)(),W=(0,ge.md)(),Be=(0,F.useState)([{id:0,idc_key:"",idc_name:""}]),_=(0,b.Z)(Be,2),ee=_[0],Ue=_[1],We=(0,F.useState)({}),re=(0,b.Z)(We,2),ze=re[0],Ye=re[1],Ke=(0,F.useState)([{id:0,env_key:"",env_name:""}]),te=(0,b.Z)(Ke,2),ae=te[0],He=te[1],Ge=(0,F.useState)({}),ne=(0,b.Z)(Ge,2),Ne=ne[0],Je=ne[1],Qe=(0,F.useState)([{id:0,name:""}]),ue=(0,b.Z)(Qe,2),se=ue[0],Xe=ue[1],qe=(0,F.useState)({}),le=(0,b.Z)(qe,2),_e=le[0],er=le[1];(0,F.useEffect)(function(){fetch("/api/v1/datasource_idc/list").then(function(n){return n.json()}).then(function(n){Ue(n.data);var i={};n.data.forEach(function(e){i[e.id]=e.idc_key}),Ye(i)}).catch(function(n){console.log("Fetch cluster list failed",n)}),fetch("/api/v1/datasource_env/list").then(function(n){return n.json()}).then(function(n){He(n.data);var i={};n.data.forEach(function(e){i[e.id]=e.env_key}),Je(i)}).catch(function(n){console.log("Fetch cluster list failed",n)}),fetch("/api/v1/datasource_type/list").then(function(n){return n.json()}).then(function(n){Xe(n.data);var i={};n.data.forEach(function(e){i[e.id]=e.name}),er(i)}).catch(function(n){console.log("Fetch cluster list failed",n)})},[]);var z=[{title:"\u6570\u636E\u6E90",dataIndex:"name",initialValue:v.name,sorter:!0,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u7C7B\u578B",dataIndex:"type",initialValue:v.type,filters:!0,onFilter:!0,sorter:!0,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,je);return(0,r.jsx)(j.Z,{showSearch:!0,children:se&&se.map(function(g){return(0,r.jsx)(Option,{value:g.name,children:g.name},g.name)})})},valueEnum:_e},{title:"\u4E3B\u673A",dataIndex:"host",initialValue:v.host,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u7AEF\u53E3",dataIndex:"port",initialValue:v.port,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u7528\u6237",dataIndex:"user",hideInTable:!0,hideInSearch:!0,initialValue:v.user},{title:"\u5BC6\u7801",dataIndex:"pass",hideInTable:!0,hideInSearch:!0,initialValue:"",valueType:"password"},{title:"DBID",dataIndex:"dbid",hideInTable:!0,hideInSearch:!0,initialValue:v.dbid},{title:"\u673A\u623F",dataIndex:"idc",initialValue:v.idc,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,Se);return(0,r.jsx)(j.Z,{showSearch:!0,children:ee&&ee.map(function(g){return(0,r.jsx)(Option,{value:g.idc_key,children:g.idc_name},g.idc_key)})})},valueEnum:ze},{title:"\u73AF\u5883",dataIndex:"env",initialValue:v.env,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,be);return(0,r.jsx)(j.Z,{showSearch:!0,children:ae&&ae.map(function(g){return(0,r.jsx)(Option,{value:g.env_key,children:g.env_name},g.env_key)})})},valueEnum:Ne},{title:"\u542F\u7528",dataIndex:"enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:v.enable,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,Ee);return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(Option,{value:0,children:"\u5426"},0),(0,r.jsx)(Option,{value:1,children:"\u662F"},1)]})}},{title:"\u67E5\u8BE2",dataIndex:"execute_enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:v.execute_enable,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,Pe);return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(Option,{value:0,children:"\u5426"},0),(0,r.jsx)(Option,{value:1,children:"\u662F"},1)]})}},{title:"\u5143\u6570\u636E",dataIndex:"dbmeta_enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:v.dbmeta_enable,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,Re);return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(Option,{value:0,children:"\u5426"},0),(0,r.jsx)(Option,{value:1,children:"\u662F"},1)]})}},{title:"\u63A2\u654F",dataIndex:"sensitive_enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:v.sensitive_enable,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,Ce);return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(Option,{value:0,children:"\u5426"},0),(0,r.jsx)(Option,{value:1,children:"\u662F"},1)]})}},{title:"\u76D1\u63A7",dataIndex:"monitor_enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:v.monitor_enable,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,Ve);return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(Option,{value:0,children:"\u5426"},0),(0,r.jsx)(Option,{value:1,children:"\u662F"},1)]})}},{title:"\u544A\u8B66",dataIndex:"alarm_enable",filters:!1,onFilter:!1,valueEnum:{0:{text:"",status:"Default"},1:{text:"",status:"Success"}},sorter:!1,initialValue:v.alarm_enable,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(i,e,m){var f=e.type,x=e.defaultRender,a=(0,S.Z)(e,Oe);return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(Option,{value:0,children:"\u5426"},0),(0,r.jsx)(Option,{value:1,children:"\u662F"},1)]})}},{title:"\u72B6\u6001",dataIndex:"status",filters:!0,onFilter:!0,render:function(i,e){return i=="1"?(0,r.jsx)(w.Z,{title:e.status_text,children:(0,r.jsx)(O.Z,{status:"success"})}):(0,r.jsx)(w.Z,{title:e.status_text,children:(0,r.jsx)(O.Z,{status:"error"})})},hideInForm:!0},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"gmt_created",sorter:!1,valueType:"dateTime",hideInForm:!0,hideInTable:!0,hideInSearch:!0},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"gmt_updated",sorter:!1,valueType:"dateTime",hideInForm:!0,hideInTable:!0,hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(i,e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("a",{onClick:function(){U(!0),q(e)},children:[(0,r.jsx)(de.Z,{}),"\u4FEE\u6539"]}),(0,r.jsx)(V.Z,{type:"vertical"}),(0,r.jsx)(D.Z,{title:"\u786E\u8BA4\u8981\u5220\u9664\u6570\u636E\u3010".concat(e.id,"\u3011,\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F"),placement:"left",onConfirm:(0,y.Z)((0,c.Z)().mark(function m(){var f;return(0,c.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(W.canAdmin){a.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),a.abrupt("return");case 3:return a.next=5,Le(e.id);case 5:f=a.sent,f&&E.current&&E.current.reload();case 7:case"end":return a.stop()}},m)})),children:(0,r.jsxs)("a",{children:[(0,r.jsx)(ce.Z,{}),"\u5220\u9664"]})})]})}}];return(0,r.jsxs)(me.ZP,{children:[(0,r.jsx)(L.ZP,(0,Z.Z)((0,Z.Z)({},Te),{},{headerTitle:"\u6570\u636E\u5217\u8868",actionRef:E,rowKey:"id",search:{labelWidth:120},toolBarRender:function(){return[(0,r.jsxs)(C.Z,{type:"primary",onClick:function(){I(!0),q(Q)},children:[(0,r.jsx)(oe.Z,{})," \u65B0\u5EFA"]})]},request:function(i,e,m){return Ze((0,Z.Z)((0,Z.Z)({},i),{},{sorter:e,filter:m}))},columns:z,pagination:{pageSize:10}})),(0,r.jsx)(pe,{onCancel:function(){return I(!1)},modalVisible:t,children:(0,r.jsx)(L.ZP,{onSubmit:function(){var n=(0,y.Z)((0,c.Z)().mark(function i(e){var m,f;return(0,c.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(W.canAdmin){a.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),a.abrupt("return");case 3:return a.next=5,J(e);case 5:if(m=a.sent,m){a.next=9;break}return p.ZP.error("\u6570\u636E\u5E93\u8FDE\u63A5\u68C0\u67E5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6E90\u914D\u7F6E\u662F\u5426\u6B63\u786E"),a.abrupt("return");case 9:return a.next=11,De(e);case 11:f=a.sent,f&&(I(!1),E.current&&E.current.reload());case 13:case"end":return a.stop()}},i)}));return function(i){return n.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:z})}),(0,r.jsx)(he,{onCancel:function(){return U(!1)},updateModalVisible:Me,children:(0,r.jsx)(L.ZP,{onSubmit:function(){var n=(0,y.Z)((0,c.Z)().mark(function i(e){var m,f;return(0,c.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(W.canAdmin){a.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),a.abrupt("return");case 3:return a.next=5,J(e);case 5:if(m=a.sent,m){a.next=9;break}return p.ZP.error("\u6570\u636E\u5E93\u8FDE\u63A5\u68C0\u67E5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6E90\u914D\u7F6E\u662F\u5426\u6B63\u786E"),a.abrupt("return");case 9:return a.next=11,we(e,v.id);case 11:f=a.sent,f&&(U(!1),E.current&&E.current.reload());case 13:case"end":return a.stop()}},i)}));return function(i){return n.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:z})})]})},Ae=$e}}]);
