(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4926],{86647:function(He,O,e){"use strict";e.r(O),e.d(O,{default:function(){return ze}});var Ke=e(58024),te=e(39144),Qe=e(66456),re=e(34424),Ge=e(13062),U=e(71230),Je=e(89032),z=e(15746),ke=e(57663),B=e(71577),Xe=e(49111),L=e(19650),qe=e(62350),ae=e(75443),_e=e(22385),R=e(61580),et=e(48736),ne=e(27049),h=e(28481),m=e(28991),tt=e(34792),p=e(48086),d=e(55507),y=e(92137),rt=e(47673),V=e(4107),v=e(67294),ue=e(47599),A=e(3140),se=e(80129);function le(o){return Y.apply(this,arguments)}function Y(){return Y=(0,y.Z)((0,d.Z)().mark(function o(n){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,A.WY)("/api/v1/alarm/suggest?".concat((0,se.stringify)(n))));case 1:case"end":return r.stop()}},o)})),Y.apply(this,arguments)}function ie(o){return b.apply(this,arguments)}function b(){return b=(0,y.Z)((0,d.Z)().mark(function o(n){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,A.WY)("/api/v1/alarm/suggest",{method:n.modify?"PUT":"POST",data:(0,m.Z)({},n)}));case 1:case"end":return r.stop()}},o)})),b.apply(this,arguments)}function oe(o){return w.apply(this,arguments)}function w(){return w=(0,y.Z)((0,d.Z)().mark(function o(n){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,A.WY)("/api/v1/alarm/suggest",{method:"DELETE",data:(0,m.Z)({},n)}));case 1:case"end":return r.stop()}},o)})),w.apply(this,arguments)}var de=e(59879),ce=e(49101),ve=e(30381),fe=e.n(ve),at=e(57338),me=e(25084),nt=e(9715),x=e(37657),N=e(71167),he=e.n(N),ge=e(30364),D=e.n(ge),t=e(85893),Ze=D().EmojiBlot,pe=D().ShortNameEmoji,ye=D().ToolbarEmoji,Se=D().TextAreaEmoji;N.Quill.register({"formats/emoji":Ze,"modules/emoji-shortname":pe,"modules/emoji-toolbar":ye,"modules/emoji-textarea":Se},!0);var je=function(n){var l=n.value,r=n.onChange,u=(0,v.useState)(""),a=(0,h.Z)(u,2),i=a[0],P=a[1],Z=function(j){r==null||r(j)};(0,v.useEffect)(function(){l&&P(l)},[l]);var I={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],["link","image"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]};return(0,t.jsx)(he(),{id:"content",defaultValue:l||i,value:l||i,theme:"snow",modules:I,className:"ql-editor content",onChange:function(j){return Z(j)}},"content")},Ee=je,Ce={labelCol:{span:5},wrapperCol:{span:16}},Fe=function(n){var l=n.updateVisible,r=n.onSubmit,u=n.onClose,a=n.values,i=x.Z.useForm(),P=(0,h.Z)(i,1),Z=P[0];return(0,v.useEffect)(function(){a!==null&&a.modify?Z.setFieldsValue((0,m.Z)({},a)):Z.resetFields()},[a]),(0,t.jsx)(me.Z,{mask:!0,width:1e3,height:680,title:a.modify?"\u4FEE\u6539 ".concat(a.event_key):"\u65B0\u589E",visible:l,onClose:u,placement:"top",forceRender:!1,footer:(0,t.jsxs)(L.Z,{children:[(0,t.jsx)(B.Z,{onClick:u,children:"\u5173\u95ED"}),(0,t.jsx)(B.Z,{onClick:function(){Z.validateFields().then(function(S){var j=(0,m.Z)((0,m.Z)({},S),{},{modify:a.modify});a.modify&&(j.id=a.id||0),r((0,m.Z)({},j)),Z.resetFields()}).catch(function(S){console.log("Validate Failed:",S)})},type:"primary",children:"\u63D0\u4EA4"})]}),children:(0,t.jsxs)(x.Z,(0,m.Z)((0,m.Z)({},Ce),{},{form:Z,children:[(0,t.jsx)(x.Z.Item,{name:"event_type",label:"\u4E8B\u4EF6\u7C7B\u578B",rules:[{required:!0}],children:(0,t.jsx)(V.Z,{style:{width:240}})}),(0,t.jsx)(x.Z.Item,{name:"event_key",label:"\u4E8B\u4EF6\u6307\u6807",rules:[{required:!0}],children:(0,t.jsx)(V.Z,{style:{width:240}})}),(0,t.jsx)(x.Z.Item,{name:"content",label:"\u5EFA\u8BAE\u5185\u5BB9",children:(0,t.jsx)(Ee,{})})]}))})},xe=Fe,Pe=e(85029),Te=V.Z.Search,Be=function(){var o=(0,y.Z)((0,d.Z)().mark(function n(l){return(0,d.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,le(l);case 3:return u.abrupt("return",u.sent);case 6:return u.prev=6,u.t0=u.catch(0),u.abrupt("return",{success:!1,msg:u.t0});case 9:case"end":return u.stop()}},n,null,[[0,6]])}));return function(l){return o.apply(this,arguments)}}(),De=function(){var o=(0,y.Z)((0,d.Z)().mark(function n(l){var r,u;return(0,d.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=p.ZP.loading("\u6B63\u5728\u914D\u7F6E"),i.prev=1,i.next=4,ie((0,m.Z)({},l));case 4:return u=i.sent,r(),p.ZP.success("\u914D\u7F6E\u6210\u529F"),i.abrupt("return",u);case 10:return i.prev=10,i.t0=i.catch(1),r(),p.ZP.error("\u914D\u7F6E\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),i.abrupt("return",{success:!1,msg:i.t0});case 15:case"end":return i.stop()}},n,null,[[1,10]])}));return function(l){return o.apply(this,arguments)}}(),Ie=function(){var o=(0,y.Z)((0,d.Z)().mark(function n(l){var r;return(0,d.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=p.ZP.loading("\u6B63\u5728\u5220\u9664"),a.prev=1,a.next=4,oe({id:l});case 4:return r(),p.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),a.abrupt("return",!0);case 9:return a.prev=9,a.t0=a.catch(1),r(),p.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},n,null,[[1,9]])}));return function(l){return o.apply(this,arguments)}}(),$e=function(){var n=(0,v.useState)([]),l=(0,h.Z)(n,2),r=l[0],u=l[1],a=(0,v.useState)(0),i=(0,h.Z)(a,2),P=i[0],Z=i[1],I=(0,v.useState)(!1),S=(0,h.Z)(I,2),j=S[0],W=S[1],Re=(0,v.useState)(!1),H=(0,h.Z)(Re,2),Ve=H[0],$=H[1],Ae=(0,v.useState)(),K=(0,h.Z)(Ae,2),Ye=K[0],M=K[1],be=(0,v.useState)(),Q=(0,h.Z)(be,2),G=Q[0],we=Q[1],Me=(0,v.useState)(1),J=(0,h.Z)(Me,2),k=J[0],Oe=J[1],Ue=(0,v.useState)(10),X=(0,h.Z)(Ue,2),q=X[0],Le=X[1],_=(0,v.useRef)(),ee=(0,Pe.md)(),T=function(s){W(!0);var c=(0,m.Z)({offset:q*(k>=2?k-1:0),limit:q,keyword:s&&s.keyword?s.keyword:G},s);Be(c).then(function(f){f.success&&(u(f.data),Z(f.total)),W(!1)})},Ne=[{title:"\u4E8B\u4EF6\u7C7B\u578B",dataIndex:"event_type",sorter:!0},{title:"\u4E8B\u4EF6\u6307\u6807",dataIndex:"event_key",sorter:!0},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createdAt",sorter:!0,render:function(s){return fe()(s).format("YYYY-MM-DD HH:mm:ss")}},{title:"\u64CD\u4F5C",dataIndex:"id",key:"id",fixed:"right",width:150,render:function(s,c){return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(L.Z,{split:(0,t.jsx)(ne.Z,{type:"vertical"}),children:[(0,t.jsx)(R.Z,{title:"\u4FEE\u6539\u3010".concat(c.event_key,"\u3011"),children:(0,t.jsx)("a",{onClick:function(){console.log("debug ---> ",c),$(!0),M((0,m.Z)((0,m.Z)({},c),{},{modify:!0}))},children:"\u4FEE\u6539"})}),(0,t.jsx)(R.Z,{title:"\u5220\u9664\u3010".concat(c.event_key,"\u3011"),children:(0,t.jsx)(ae.Z,{title:"\u5220\u9664\u3010".concat(c.event_key,"\u3011\uFF0C\u5220\u9664\u540E\u6570\u636E\u4E0D\u53EF\u6062\u590D\u3002\u662F\u5426\u7EE7\u7EED\uFF1F"),placement:"left",onConfirm:(0,y.Z)((0,d.Z)().mark(function f(){var C;return(0,d.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(ee.canAdmin){F.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),F.abrupt("return");case 3:return F.next=5,Ie(c.id);case 5:C=F.sent,C&&_.current&&_.current.reload();case 7:case"end":return F.stop()}},f)})),children:(0,t.jsx)("a",{children:"\u5220\u9664"})})})]})})}}];(0,v.useEffect)(function(){T("")},[]);var We=function(s,c,f){var C={offset:s.pageSize*(s.current>=2?s.current-1:0),limit:s.pageSize,keyword:G,sorterField:"",sorterOrder:""};f.field&&(C.sorterField="".concat(f.field),C.sorterOrder="".concat(f.order)),Oe(s.current),Le(s.pageSize),T(C)};return(0,t.jsxs)(ue.ZP,{children:[(0,t.jsxs)(te.Z,{size:"small",bodyStyle:{padding:10},children:[(0,t.jsxs)(U.Z,{children:[(0,t.jsxs)(z.Z,{flex:"auto",children:[(0,t.jsx)(Te,{placeholder:"\u652F\u6301\u641C\u7D22\u4E8B\u4EF6\u7C7B\u578B\u3001\u4E8B\u4EF6\u6307\u6807",onSearch:function(s){console.log("debug on search --> ",s),we(s),T({keyword:s})},style:{width:280}}),(0,t.jsx)(R.Z,{placement:"top",title:"\u91CD\u8F7D\u5E76\u5237\u65B0\u8868\u683C\u6570\u636E",children:(0,t.jsx)(B.Z,{type:"link",icon:(0,t.jsx)(de.Z,{}),onClick:function(){return T("")}})})]}),(0,t.jsx)(z.Z,{span:2,children:(0,t.jsx)(B.Z,{type:"link",icon:(0,t.jsx)(ce.Z,{}),onClick:function(){return $(!0)},children:"\u65B0\u589E"})})]}),(0,t.jsx)(U.Z,{style:{paddingTop:10},children:(0,t.jsx)(z.Z,{span:24,children:(0,t.jsx)(re.Z,{size:"small",rowKey:"id",loading:j,columns:Ne,dataSource:r,onChange:We,pagination:{total:P,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],showQuickJumper:!0,showTotal:function(s,c){return"\u7B2C ".concat(c[0],"-").concat(c[1],"\u6761\uFF0C \u5171 ").concat(s,"\u6761")}}})})})]}),(0,t.jsx)(xe,{onSubmit:function(){var g=(0,y.Z)((0,d.Z)().mark(function s(c){var f;return(0,d.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(ee.canAdmin){E.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),E.abrupt("return");case 3:return E.next=5,De(c);case 5:f=E.sent,f.success&&(T(""),$(!1),M(void 0));case 7:case"end":return E.stop()}},s)}));return function(s){return g.apply(this,arguments)}}(),onClose:function(){$(!1),M(void 0)},updateVisible:Ve,values:Ye||{}})]})},ze=$e}}]);
