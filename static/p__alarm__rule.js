(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[8654],{54977:function(re,S,a){"use strict";a.d(S,{Z:function(){return W}});var b=a(28991),V=a(67294),K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},A=K,H=a(27029),B=function(C,j){return V.createElement(H.Z,(0,b.Z)((0,b.Z)({},C),{},{ref:j,icon:A}))};B.displayName="FormOutlined";var W=V.forwardRef(B)},37979:function(re,S,a){"use strict";a.r(S),a.d(S,{default:function(){return Ce}});var b=a(57663),V=a(71577),K=a(62350),A=a(75443),H=a(48736),B=a(27049),W=a(43358),R=a(34041),C=a(81253),j=a(28481),d=a(55507),x=a(28991),Me=a(34792),p=a(48086),y=a(92137),te=a(54977),ae=a(73171),ne=a(49101),I=a(67294),ue=a(47599),L=a(40418),Te=a(71194),G=a(77175),e=a(85893),le=function(u){var o=u.modalVisible,r=u.onCancel;return(0,e.jsx)(G.Z,{destroyOnClose:!0,title:"\u65B0\u5EFA\u544A\u8B66\u89C4\u5219",visible:o,onCancel:function(){return r()},footer:null,children:u.children})},se=le,ie=function(u){var o=u.updateModalVisible,r=u.onCancel;return(0,e.jsx)(G.Z,{destroyOnClose:!0,title:"\u4FEE\u6539\u544A\u8B66\u89C4\u5219",visible:o,onCancel:function(){return r()},footer:null,children:u.children})},de=ie,O=a(11238);function ce(s){return w.apply(this,arguments)}function w(){return w=(0,y.Z)((0,d.Z)().mark(function s(u){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.ZP)("/api/v1/alarm/rule",{params:u}));case 1:case"end":return r.stop()}},s)})),w.apply(this,arguments)}function oe(s){return $.apply(this,arguments)}function $(){return $=(0,y.Z)((0,d.Z)().mark(function s(u){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.ZP)("/api/v1/alarm/rule",{method:"DELETE",data:(0,x.Z)({},u)}));case 1:case"end":return r.stop()}},s)})),$.apply(this,arguments)}function me(s){return M.apply(this,arguments)}function M(){return M=(0,y.Z)((0,d.Z)().mark(function s(u){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.ZP)("/api/v1/alarm/rule",{method:"POST",data:(0,x.Z)({},u)}));case 1:case"end":return r.stop()}},s)})),M.apply(this,arguments)}function ve(s){return T.apply(this,arguments)}function T(){return T=(0,y.Z)((0,d.Z)().mark(function s(u){return(0,d.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.ZP)("/api/v1/alarm/rule",{method:"PUT",data:(0,x.Z)({},u)}));case 1:case"end":return r.stop()}},s)})),T.apply(this,arguments)}var fe=a(85029),he=["type","defaultRender"],pe=["type","defaultRender"],Ze=["type","defaultRender"],Fe=["type","defaultRender"],xe=["type","defaultRender"],ye=function(){var s=(0,y.Z)((0,d.Z)().mark(function u(o){var r;return(0,d.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return r=p.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),l.prev=1,l.next=4,me((0,x.Z)({},o));case 4:return r(),p.ZP.success("\u6DFB\u52A0\u6210\u529F"),l.abrupt("return",!0);case 9:return l.prev=9,l.t0=l.catch(1),r(),p.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),l.abrupt("return",!1);case 14:case"end":return l.stop()}},u,null,[[1,9]])}));return function(o){return s.apply(this,arguments)}}(),je=function(){var s=(0,y.Z)((0,d.Z)().mark(function u(o,r){var F;return(0,d.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return F=p.ZP.loading("\u6B63\u5728\u914D\u7F6E"),h.prev=1,h.next=4,ve((0,x.Z)((0,x.Z)({},o),{},{id:r}));case 4:return F(),p.ZP.success("\u4FEE\u6539\u6210\u529F"),h.abrupt("return",!0);case 9:return h.prev=9,h.t0=h.catch(1),F(),p.ZP.error("\u4FEE\u6539\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),h.abrupt("return",!1);case 14:case"end":return h.stop()}},u,null,[[1,9]])}));return function(o,r){return s.apply(this,arguments)}}(),Ie=function(){var s=(0,y.Z)((0,d.Z)().mark(function u(o){var r;return(0,d.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return r=p.ZP.loading("\u6B63\u5728\u5220\u9664"),l.prev=1,l.next=4,oe({id:o});case 4:return r(),p.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),l.abrupt("return",!0);case 9:return l.prev=9,l.t0=l.catch(1),r(),p.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),l.abrupt("return",!1);case 14:case"end":return l.stop()}},u,null,[[1,9]])}));return function(o){return s.apply(this,arguments)}}();function m(s){return(0,e.jsx)("option",(0,x.Z)((0,x.Z)({},s),{},{children:s.children}))}var N={title:"",event_type:"",event_group:"",event_key:"",event_entity:"",alarm_rule:"",alarm_value:"",alarm_times:"",alarm_sleep:"",level_id:"",channel_id:"",enable:""},ge=function(){var u=(0,I.useState)(!1),o=(0,j.Z)(u,2),r=o[0],F=o[1],l=(0,I.useState)(!1),h=(0,j.Z)(l,2),Pe=h[0],D=h[1],Ee=(0,I.useState)(N),J=(0,j.Z)(Ee,2),v=J[0],Q=J[1],P=(0,I.useRef)(),U=(0,fe.md)(),Re=(0,I.useState)([{id:0,level_name:""}]),X=(0,j.Z)(Re,2),Y=X[0],Se=X[1],Ve=(0,I.useState)({}),k=(0,j.Z)(Ve,2),Be=k[0],Oe=k[1],be=(0,I.useState)([{id:0,name:""}]),q=(0,j.Z)(be,2),_=q[0],Ae=q[1],Le=(0,I.useState)({}),ee=(0,j.Z)(Le,2),we=ee[0],$e=ee[1];(0,I.useEffect)(function(){fetch("/api/v1/alarm/level").then(function(n){return n.json()}).then(function(n){Se(n.data);var c={};n.data.forEach(function(t){c[t.id]=t.level_name}),Oe(c)}).catch(function(n){console.log("Fetch level list failed",n)}),fetch("/api/v1/alarm/channel").then(function(n){return n.json()}).then(function(n){Ae(n.data);var c={};n.data.forEach(function(t){c[t.id]=t.name}),$e(c)}).catch(function(n){console.log("Fetch cluster list failed",n)})},[]),console.info(v),console.info(v.level_id);var z=[{title:"\u89C4\u5219\u540D\u79F0",dataIndex:"title",hideInForm:!1,sorter:!0,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},initialValue:v.title},{title:"\u4E8B\u4EF6\u7C7B\u578B",dataIndex:"event_type",hideInForm:!1,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},initialValue:v.event_type},{title:"\u4E8B\u4EF6\u6307\u6807",dataIndex:"event_key",hideInForm:!1,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},initialValue:v.event_key},{title:"\u4E8B\u4EF6\u7EC4",dataIndex:"event_group",hideInForm:!1,initialValue:v.event_group},{title:"\u4E8B\u4EF6\u5B9E\u4F53",dataIndex:"event_entity",hideInForm:!1,initialValue:v.event_entity},{title:"\u544A\u8B66\u89C4\u5219",dataIndex:"alarm_rule",hideInForm:!1,search:!1,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},valueEnum:{"=":{text:"\u7B49\u4E8E"},"!=":{text:"\u4E0D\u7B49\u4E8E"},">":{text:"\u5927\u4E8E"},">=":{text:"\u5927\u4E8E\u7B49\u4E8E"},"<":{text:"\u5C0F\u4E8E"},"<=":{text:"\u5C0F\u4E8E\u7B49\u4E8E"}},initialValue:v.alarm_rule},{title:"\u544A\u8B66\u503C",dataIndex:"alarm_value",hideInForm:!1,search:!1,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},initialValue:v.alarm_value},{title:"\u544A\u8B66\u7EA7\u522B",dataIndex:"level_id",initialValue:v.level_id,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(c,t,f){var g=t.type,i=t.defaultRender,Z=(0,C.Z)(t,he);return(0,e.jsx)(R.Z,{showSearch:!0,children:Y&&Y.map(function(E){return(0,e.jsx)(Option,{value:E.id,children:E.level_name},E.level_name)})})},valueEnum:Be},{title:"\u901A\u77E5\u6E20\u9053",dataIndex:"channel_id",initialValue:v.channel_id,hideInForm:!1,search:!1,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(c,t,f){var g=t.type,i=t.defaultRender,Z=(0,C.Z)(t,pe);return(0,e.jsx)(R.Z,{showSearch:!0,children:_&&_.map(function(E){return(0,e.jsx)(Option,{value:E.id,children:E.name},E.name)})})},valueEnum:we},{title:"\u9650\u6D41\u6B21\u6570",dataIndex:"alarm_times",hideInForm:!1,search:!1,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},valueEnum:{1:{text:"1\u6B21"},2:{text:"2\u6B21"},3:{text:"3\u6B21"},4:{text:"4\u6B21"},5:{text:"5\u6B21"},6:{text:"6\u6B21"},7:{text:"7\u6B21"},8:{text:"8\u6B21"}},initialValue:v.alarm_times,renderFormItem:function(c,t,f){var g=t.type,i=t.defaultRender,Z=(0,C.Z)(t,Ze);return(0,e.jsxs)(R.Z,{children:[(0,e.jsx)(m,{value:1,children:"1\u6B21"}),(0,e.jsx)(m,{value:2,children:"2\u6B21"}),(0,e.jsx)(m,{value:3,children:"3\u6B21"}),(0,e.jsx)(m,{value:4,children:"4\u6B21"}),(0,e.jsx)(m,{value:5,children:"5\u6B21"}),(0,e.jsx)(m,{value:6,children:"6\u6B21"}),(0,e.jsx)(m,{value:7,children:"7\u6B21"}),(0,e.jsx)(m,{value:8,children:"8\u6B21"})]})}},{title:"\u98CE\u63A7\u65F6\u95F4",dataIndex:"alarm_sleep",hideInForm:!1,search:!1,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},valueEnum:{300:{text:"5\u5206\u949F"},900:{text:"15\u5206\u949F"},1800:{text:"30\u5206\u949F"},3600:{text:"1\u5C0F\u65F6"},10800:{text:"3\u5C0F\u65F6"},21600:{text:"6\u5C0F\u65F6"},43200:{text:"12\u5C0F\u65F6"},86400:{text:"24\u5C0F\u65F6"}},initialValue:v.alarm_sleep,renderFormItem:function(c,t,f){var g=t.type,i=t.defaultRender,Z=(0,C.Z)(t,Fe);return(0,e.jsxs)(R.Z,{children:[(0,e.jsx)(m,{value:300,children:"5\u5206\u949F"}),(0,e.jsx)(m,{value:900,children:"15\u5206\u949F"}),(0,e.jsx)(m,{value:1800,children:"30\u5206\u949F"}),(0,e.jsx)(m,{value:3600,children:"1\u5C0F\u65F6"}),(0,e.jsx)(m,{value:10800,children:"3\u5C0F\u65F6"}),(0,e.jsx)(m,{value:21600,children:"6\u5C0F\u65F6"}),(0,e.jsx)(m,{value:43200,children:"12\u5C0F\u65F6"}),(0,e.jsx)(m,{value:86400,children:"24\u5C0F\u65F6"})]})}},{title:"\u72B6\u6001",dataIndex:"enable",filters:!0,onFilter:!0,valueEnum:{0:{text:"\u7981\u7528",status:"Default"},1:{text:"\u542F\u7528",status:"Success"}},sorter:!0,initialValue:v.enable,formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]},renderFormItem:function(c,t,f){var g=t.type,i=t.defaultRender,Z=(0,C.Z)(t,xe);return(0,e.jsxs)(R.Z,{children:[(0,e.jsx)(m,{value:0,children:"\u7981\u7528"}),(0,e.jsx)(m,{value:1,children:"\u542F\u7528"})]})}},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(c,t){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("a",{onClick:function(){D(!0),Q(t)},children:[(0,e.jsx)(te.Z,{}),"\u4FEE\u6539"]}),(0,e.jsx)(B.Z,{type:"vertical"}),(0,e.jsx)(A.Z,{title:"\u786E\u8BA4\u8981\u5220\u9664\u6570\u636E\u3010".concat(t.title,"\u3011,\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F"),placement:"left",onConfirm:(0,y.Z)((0,d.Z)().mark(function f(){var g;return(0,d.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(U.canAdmin){Z.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),Z.abrupt("return");case 3:return Z.next=5,Ie(t.id);case 5:g=Z.sent,g&&P.current&&P.current.reload();case 7:case"end":return Z.stop()}},f)})),children:(0,e.jsxs)("a",{children:[(0,e.jsx)(ae.Z,{}),"\u5220\u9664"]})})]})}}];return(0,e.jsxs)(ue.ZP,{children:[(0,e.jsx)(L.ZP,{headerTitle:"\u6570\u636E\u5217\u8868",actionRef:P,rowKey:"id",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsxs)(V.Z,{type:"primary",onClick:function(){F(!0),Q(N)},children:[(0,e.jsx)(ne.Z,{})," \u65B0\u5EFA"]})]},request:function(c,t,f){return ce((0,x.Z)((0,x.Z)({},c),{},{sorter:t,filter:f}))},columns:z,pagination:{pageSize:20}}),(0,e.jsx)(se,{onCancel:function(){return F(!1)},modalVisible:r,children:(0,e.jsx)(L.ZP,{onSubmit:function(){var n=(0,y.Z)((0,d.Z)().mark(function c(t){var f;return(0,d.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(U.canAdmin){i.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),i.abrupt("return");case 3:return i.next=5,ye(t);case 5:f=i.sent,f&&(F(!1),P.current&&P.current.reload());case 7:case"end":return i.stop()}},c)}));return function(c){return n.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:z})}),(0,e.jsx)(de,{onCancel:function(){return D(!1)},updateModalVisible:Pe,children:(0,e.jsx)(L.ZP,{onSubmit:function(){var n=(0,y.Z)((0,d.Z)().mark(function c(t){var f;return(0,d.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(U.canAdmin){i.next=3;break}return p.ZP.error("\u64CD\u4F5C\u6743\u9650\u53D7\u9650\uFF0C\u8BF7\u8054\u7CFB\u5E73\u53F0\u7BA1\u7406\u5458"),i.abrupt("return");case 3:return i.next=5,je(t,v.id);case 5:f=i.sent,f&&(D(!1),P.current&&P.current.reload());case 7:case"end":return i.stop()}},c)}));return function(c){return n.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:z})})]})},Ce=ge}}]);
